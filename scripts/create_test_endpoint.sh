#!/bin/bash

# 创建一个包含数组类型字段的测试端点
curl -X POST http://localhost:3000/api/swagger \
  -H "Content-Type: application/json" \
  -d '{
  "endpoint_name": "array-test-endpoint",
  "description": "测试数组类型字段展示的端点",
  "swagger_content": "{\n  \"openapi\": \"3.1.0\",\n  \"info\": {\n    \"title\": \"Array Type Test API\",\n    \"description\": \"测试数组类型字段接口\",\n    \"version\": \"1.0.0\"\n  },\n  \"servers\": [\n    {\n      \"url\": \"http://array-test-service.dev.starcharge.cloud\"\n    }\n  ],\n  \"paths\": {\n    \"/users\": {\n      \"get\": {\n        \"summary\": \"获取用户列表\",\n        \"description\": \"返回用户列表信息，包含复杂对象数组\",\n        \"operationId\": \"getUsers\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"成功响应\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"users\": {\n                      \"type\": \"array\",\n                      \"description\": \"用户列表\",\n                      \"items\": {\n                        \"type\": \"object\",\n                        \"properties\": {\n                          \"id\": {\n                            \"type\": \"integer\",\n                            \"description\": \"用户ID\"\n                          },\n                          \"name\": {\n                            \"type\": \"string\",\n                            \"description\": \"用户姓名\"\n                          },\n                          \"email\": {\n                            \"type\": \"string\",\n                            \"description\": \"用户邮箱\"\n                          },\n                          \"tags\": {\n                            \"type\": \"array\",\n                            \"description\": \"用户标签\",\n                            \"items\": {\n                              \"type\": \"string\",\n                              \"description\": \"标签名称\"\n                            }\n                          },\n                          \"profile\": {\n                            \"type\": \"object\",\n                            \"description\": \"用户资料\",\n                            \"properties\": {\n                              \"age\": {\n                                \"type\": \"integer\",\n                                \"description\": \"年龄\"\n                              },\n                              \"address\": {\n                                \"type\": \"string\",\n                                \"description\": \"地址\"\n                              },\n                              \"skills\": {\n                                \"type\": \"array\",\n                                \"description\": \"技能列表\",\n                                \"items\": {\n                                  \"type\": \"object\",\n                                  \"properties\": {\n                                    \"name\": {\n                                      \"type\": \"string\",\n                                      \"description\": \"技能名称\"\n                                    },\n                                    \"level\": {\n                                      \"type\": \"string\",\n                                      \"description\": \"技能等级\",\n                                      \"enum\": [\"beginner\", \"intermediate\", \"advanced\"]\n                                    }\n                                  },\n                                  \"required\": [\"name\", \"level\"]\n                                }\n                              }\n                            },\n                            \"required\": [\"age\"]\n                          }\n                        },\n                        \"required\": [\"id\", \"name\"]\n                      }\n                    },\n                    \"total\": {\n                      \"type\": \"integer\",\n                      \"description\": \"总用户数\"\n                    }\n                  },\n                  \"required\": [\"users\", \"total\"]\n                }\n              }\n            }\n          }\n        }\n      },\n      \"post\": {\n        \"summary\": \"创建用户\",\n        \"description\": \"创建新用户，请求体包含数组类型字段\",\n        \"operationId\": \"createUser\",\n        \"requestBody\": {\n          \"required\": true,\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"type\": \"object\",\n                \"properties\": {\n                  \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"用户姓名\"\n                  },\n                  \"emails\": {\n                    \"type\": \"array\",\n                    \"description\": \"用户邮箱列表\",\n                    \"items\": {\n                      \"type\": \"string\",\n                      \"description\": \"邮箱地址\"\n                    }\n                  },\n                  \"preferences\": {\n                    \"type\": \"array\",\n                    \"description\": \"用户偏好设置\",\n                    \"items\": {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"category\": {\n                          \"type\": \"string\",\n                          \"description\": \"偏好类别\"\n                        },\n                        \"enabled\": {\n                          \"type\": \"boolean\",\n                          \"description\": \"是否启用\"\n                        }\n                      },\n                      \"required\": [\"category\", \"enabled\"]\n                    }\n                  }\n                },\n                \"required\": [\"name\", \"emails\"]\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"用户创建成功\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"id\": {\n                      \"type\": \"integer\",\n                      \"description\": \"用户ID\"\n                    },\n                    \"message\": {\n                      \"type\": \"string\",\n                      \"description\": \"成功消息\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}"
}'